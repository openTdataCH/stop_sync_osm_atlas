def get_atlas_stops(output_path, download_url):
    response = requests.get(download_url)
    response.raise_for_status()
    with zipfile.ZipFile(io.BytesIO(response.content)) as z:
        csv_filename = z.namelist()[0]
        with z.open(csv_filename) as f:
            df = pd.read_csv(f, sep=';')
            # Suisse (UIC pays = 85) et coordonnees valides (WGS84)
            df = df[df['uicCountryCode'] == 85]
            df = df.dropna(subset=['wgs84North', 'wgs84East'])
            # Filtre géographique: boîte WGS84 Suisse (lat \in [45.4, 47.9], lon \in [5.7, 10.7])
            df['wgs84North'] = pd.to_numeric(df['wgs84North'], errors='coerce')
            df['wgs84East'] = pd.to_numeric(df['wgs84East'], errors='coerce')
            df = df[df['wgs84North'].between(45.4, 47.9) & df['wgs84East'].between(5.7, 10.7)]
            # Comptage des quais
            boarding_platforms = df[df['trafficPointElementType'] == 'BOARDING_PLATFORM']
            df.to_csv(output_path, sep=';', index=False)
